<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>9 Multiple Linear Regression | OpenIntro Statistics: Labs for R</title>
  <meta name="description" content="This book contains labs for an introduction to statistics course. Each lab steps through the process of using the R programming language for collecting, analyzing, and using statistical data to make inferences and conclusions about real world phenomena.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="9 Multiple Linear Regression | OpenIntro Statistics: Labs for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains labs for an introduction to statistics course. Each lab steps through the process of using the R programming language for collecting, analyzing, and using statistical data to make inferences and conclusions about real world phenomena." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Multiple Linear Regression | OpenIntro Statistics: Labs for R" />
  
  <meta name="twitter:description" content="This book contains labs for an introduction to statistics course. Each lab steps through the process of using the R programming language for collecting, analyzing, and using statistical data to make inferences and conclusions about real world phenomena." />
  

<meta name="author" content="Andrew Bray">
<meta name="author" content="Mine Çetinkaya-Rundel">
<meta name="author" content="Arend Kuyper">


<meta name="date" content="2019-01-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-linear-regression.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Google Scholar -->
<meta name="citation_title" content="9 Multiple Linear Regression | OpenIntro Statistics: Labs for R">
<meta name="citation_author" content="Bray, Andrew">
<meta name="citation_author" content="Çetinkaya-Rundel, Mine">
<meta name="citation_author" content="Kuyper, Arend">
<meta name="citation_publication_date" content="2018">
<meta name="citation_epub_url" content="https://nulib.github.io/kuyper-stat202/kuyper-stat202.epub">
<meta name="citation_pdf_url" content="https://nulib.github.io/kuyper-stat202/kuyper-stat202.pdf">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116823108-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116823108-3');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">OpenIntro Statistics: Labs for R</a></li>
<li><a href="https://goo.gl/forms/sFCy9jDaTQfrZtuW2">Report an error</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#working-efficiently-with-rstudio"><i class="fa fa-check"></i><b>0.1</b> Working Efficiently with RStudio</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#why-rstudio"><i class="fa fa-check"></i><b>0.1.1</b> Why RStudio?</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#setting-up-an-r-project"><i class="fa fa-check"></i><b>0.1.2</b> Setting Up an R Project</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#summary"><i class="fa fa-check"></i><b>0.1.3</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-data-dr.arbuthnots-baptism-records"><i class="fa fa-check"></i><b>1.1</b> The Data: Dr. Arbuthnot’s Baptism Records</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#some-exploration"><i class="fa fa-check"></i><b>1.2</b> Some Exploration</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#on-your-own"><i class="fa fa-check"></i><b>1.3</b> On Your Own</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-data.html"><a href="introduction-to-data.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-data.html"><a href="introduction-to-data.html#summaries-and-tables"><i class="fa fa-check"></i><b>2.2</b> Summaries and tables</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-data.html"><a href="introduction-to-data.html#interlude-how-r-thinks-about-data"><i class="fa fa-check"></i><b>2.3</b> Interlude: How R thinks about data</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-data.html"><a href="introduction-to-data.html#a-little-more-on-subsetting"><i class="fa fa-check"></i><b>2.4</b> A little more on subsetting</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-data.html"><a href="introduction-to-data.html#quantitative-data"><i class="fa fa-check"></i><b>2.5</b> Quantitative data</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-data.html"><a href="introduction-to-data.html#on-your-own-1"><i class="fa fa-check"></i><b>2.6</b> On Your Own</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html"><i class="fa fa-check"></i><b>3</b> The Normal Distribution</a><ul>
<li class="chapter" data-level="3.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#getting-started-1"><i class="fa fa-check"></i><b>3.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#the-data"><i class="fa fa-check"></i><b>3.2</b> The Data</a></li>
<li class="chapter" data-level="3.3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#normal-distribution"><i class="fa fa-check"></i><b>3.3</b> Normal distribution</a></li>
<li class="chapter" data-level="3.4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#evaluating-the-normal-distribution"><i class="fa fa-check"></i><b>3.4</b> Evaluating the normal distribution</a></li>
<li class="chapter" data-level="3.5" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#normal-probabilities"><i class="fa fa-check"></i><b>3.5</b> Normal probabilities</a></li>
<li class="chapter" data-level="3.6" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#on-your-own-2"><i class="fa fa-check"></i><b>3.6</b> On Your Own</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html"><i class="fa fa-check"></i><b>4</b> Foundations for Statistical Inference - Sampling Distributions</a><ul>
<li class="chapter" data-level="4.1" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#getting-started-2"><i class="fa fa-check"></i><b>4.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#the-data-1"><i class="fa fa-check"></i><b>4.2</b> The data</a></li>
<li class="chapter" data-level="4.3" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#the-unknown-sampling-distribution"><i class="fa fa-check"></i><b>4.3</b> The unknown sampling distribution</a></li>
<li class="chapter" data-level="4.4" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#interlude-the-for-loop"><i class="fa fa-check"></i><b>4.4</b> Interlude: The <code>for</code> loop</a></li>
<li class="chapter" data-level="4.5" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#sample-size-and-the-sampling-distribution"><i class="fa fa-check"></i><b>4.5</b> Sample size and the sampling distribution</a></li>
<li class="chapter" data-level="4.6" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#on-your-own-3"><i class="fa fa-check"></i><b>4.6</b> On your own</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Confidence Intervals - Foundations for Statistical Inference</a><ul>
<li class="chapter" data-level="5.1" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#sampling-from-ames-iowa"><i class="fa fa-check"></i><b>5.1</b> Sampling from Ames, Iowa</a></li>
<li class="chapter" data-level="5.2" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#the-data-2"><i class="fa fa-check"></i><b>5.2</b> The data</a></li>
<li class="chapter" data-level="5.3" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>5.3</b> Confidence intervals</a></li>
<li class="chapter" data-level="5.4" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#confidence-levels"><i class="fa fa-check"></i><b>5.4</b> Confidence levels</a></li>
<li class="chapter" data-level="5.5" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#on-your-own-4"><i class="fa fa-check"></i><b>5.5</b> On your own</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html"><i class="fa fa-check"></i><b>6</b> Inference for Numerical Data</a><ul>
<li class="chapter" data-level="6.1" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#overview"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#north-carolina-births"><i class="fa fa-check"></i><b>6.2</b> North Carolina births</a></li>
<li class="chapter" data-level="6.3" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#exploratory-analysis"><i class="fa fa-check"></i><b>6.3</b> Exploratory analysis</a></li>
<li class="chapter" data-level="6.4" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#on-your-own-5"><i class="fa fa-check"></i><b>6.4</b> On your own</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html"><i class="fa fa-check"></i><b>7</b> Inference for Categorical Data</a><ul>
<li class="chapter" data-level="7.0.1" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#getting-started-3"><i class="fa fa-check"></i><b>7.0.1</b> Getting Started</a></li>
<li class="chapter" data-level="7.1" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#the-survey"><i class="fa fa-check"></i><b>7.1</b> The survey</a></li>
<li class="chapter" data-level="7.2" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#the-data-3"><i class="fa fa-check"></i><b>7.2</b> The data</a></li>
<li class="chapter" data-level="7.3" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#inference-on-proportions"><i class="fa fa-check"></i><b>7.3</b> Inference on proportions</a></li>
<li class="chapter" data-level="7.4" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#how-does-the-proportion-affect-the-margin-of-error"><i class="fa fa-check"></i><b>7.4</b> How does the proportion affect the margin of error?</a></li>
<li class="chapter" data-level="7.5" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#success-failure-condition"><i class="fa fa-check"></i><b>7.5</b> Success-failure condition</a></li>
<li class="chapter" data-level="7.6" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#on-your-own-6"><i class="fa fa-check"></i><b>7.6</b> On your own</a></li>
<li class="chapter" data-level="7.7" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#options-for-using-built-in-functions-in-r-prop.test-binom.test"><i class="fa fa-check"></i><b>7.7</b> Options for using built in functions in R: <code>prop.test()</code> &amp; <code>binom.test()</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Introduction to Linear Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#batter-up-getting-started"><i class="fa fa-check"></i><b>8.1</b> Batter up (Getting Started)</a></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-4"><i class="fa fa-check"></i><b>8.2</b> The data</a></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#sum-of-squared-residuals"><i class="fa fa-check"></i><b>8.3</b> Sum of squared residuals</a></li>
<li class="chapter" data-level="8.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-linear-model"><i class="fa fa-check"></i><b>8.4</b> The linear model</a></li>
<li class="chapter" data-level="8.5" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#prediction-and-prediction-errors"><i class="fa fa-check"></i><b>8.5</b> Prediction and prediction errors</a></li>
<li class="chapter" data-level="8.6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>8.6</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.7" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#on-your-own-7"><i class="fa fa-check"></i><b>8.7</b> On Your Own</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>9</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#getting-started-4"><i class="fa fa-check"></i><b>9.1</b> Getting Started</a></li>
<li class="chapter" data-level="9.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#the-data-5"><i class="fa fa-check"></i><b>9.2</b> The data</a></li>
<li class="chapter" data-level="9.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#the-search-for-the-best-model"><i class="fa fa-check"></i><b>9.3</b> The search for the best model</a><ul>
<li class="chapter" data-level="9.3.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#predicting-runs-with-backward-selection"><i class="fa fa-check"></i><b>9.3.1</b> Predicting runs with backward selection</a></li>
<li class="chapter" data-level="9.3.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#predicting-runs-with-forward-selection"><i class="fa fa-check"></i><b>9.3.2</b> Predicting runs with forward selection</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#assessing-the-conditions"><i class="fa fa-check"></i><b>9.4</b> Assessing the conditions</a></li>
<li class="chapter" data-level="9.5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#on-your-own-8"><i class="fa fa-check"></i><b>9.5</b> On Your Own</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.library.northwestern.edu/research/scholarly/digital-publishing.html" target="blank">Published by Northwestern University Libraries</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">OpenIntro Statistics: Labs for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-linear-regression" class="section level1">
<h1><span class="header-section-number">9</span> Multiple Linear Regression</h1>
<p>This lab is structured to guide you through an organized process such that you could easily organize your code with comments — meaning your R script — into a lab report. We would suggest getting into the habit of writing an organized and commented R script that completes the tasks and answers the questions provided in the lab — including in the <strong>Own Your Own</strong> section.</p>
<hr />
<div id="getting-started-4" class="section level2">
<h2><span class="header-section-number">9.1</span> Getting Started</h2>
<p>Recall that we explored simple linear regression by examining baseball data from the 2011 Major League Baseball (MLB) season. We will also use this data to explore multiple regression. Our inspiration for exploring this data stems from the movie <a href="http://en.wikipedia.org/wiki/Moneyball_(film)">Moneyball</a>, which focused on the “quest for the secret of success in baseball”. It follows a low-budget team, the Oakland Athletics, who believed that underused statistics, such as a player’s ability to get on base, better predict the ability to score runs than typical statistics like home runs, RBIs (runs batted in), and batting average. Obtaining players who excelled in these underused statistics turned out to be much more affordable for the team.</p>
<p>In this lab we’ll be looking at data from all 30 Major League Baseball teams and examining the linear relationship between runs scored in a season and a number of other player statistics. Our aim will be to find the model that best predicts a team’s runs scored in a season. We also aim to find the model that best predicts a team’s total wins in a season. The first model would tell us which player statistics we should pay attention to if we wish to purchase runs and the second model would indicate which player statistics we should utilize when we wish to purchase wins.</p>
</div>
<div id="the-data-5" class="section level2">
<h2><span class="header-section-number">9.2</span> The data</h2>
<p>Let’s load up the data for the 2011 season.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;http://www.openintro.org/stat/data/mlb11.RData&quot;</span>, <span class="dt">destfile =</span> <span class="st">&quot;mlb11.RData&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;mlb11.RData&quot;</span>)</code></pre></div>
<p>In addition to runs scored, there are seven traditionally used variables in the data set: at-bats, hits, home runs, batting average, strikeouts, stolen bases, and wins. There are also three newer variables: on-base percentage, slugging percentage, and on-base plus slugging. For the first portion of the analysis we’ll consider the seven traditional variables. At the end of the lab, you’ll work with the newer variables on your own.</p>
<p>We also would like to modify the data so that it easier to work with during model selection. We remove the variable team from the dataset and store the updated verison in <code>mlb11_wins</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mlb11_wins &lt;-<span class="st"> </span>mlb11[,<span class="op">-</span><span class="dv">1</span>] <span class="co"># since team is in the first column we can us -1 to remove it</span></code></pre></div>
<p>Since <code>wins</code> is not a player level statistic - at least for non-pitchers - we do not want to use it when predicting <code>runs</code>. Therefore we are going to create another modified dataset to utilize when attempting to find the best model for predicting the total number of <code>runs</code> for a team during a season. The reverse is not an issue when attempting to predict a team’s number of wins for a season - <code>runs</code> can be used to predict <code>wins</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mlb11_runs &lt;-<span class="st"> </span>mlb11_wins[,<span class="op">-</span><span class="dv">8</span>] <span class="co"># since wins is in the 8th column we can us -8 to remove it</span></code></pre></div>
<p>As discussed in class there are many ways to go about model selection. We will look at both forward and backward selection methods that utilize</p>
</div>
<div id="the-search-for-the-best-model" class="section level2">
<h2><span class="header-section-number">9.3</span> The search for the best model</h2>
<p>As discussed in class there are many ways to go about model selection. We will look at both forward and backward selection methods that utilize different criterions (<span class="math inline">\(R^2_{adj}\)</span>, p-values, or AIC).</p>
<div id="predicting-runs-with-backward-selection" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Predicting runs with backward selection</h3>
<p>The first step in backward selection is to define a full model. Since we created a modified dataset for predicting runs we can use a shortcut, <code>runs ~ .</code>, for telling R to use all remaining variables to predict runs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">runs_full &lt;-<span class="st"> </span><span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> mlb11_runs)
<span class="kw">summary</span>(runs_full)</code></pre></div>
<hr />
<p><strong>Exercise 1:</strong> How many variables are being used to predict <code>runs</code> in the full model? How many parameters are being estimated in the full model? How many of the parameters are significantly different than 0 at the 0.05 level? What is the full model’s <span class="math inline">\(R^2_{adj}\)</span>?</p>
<hr />
<p>Now that we have a full model defined we can go about backwards model selection. The <code>step()</code> function in R makes it extremely easy to use AIC (Akiake’s Information Criterion) for model selection. Similar to <span class="math inline">\(R^2_{adj}\)</span>, AIC applies a penalty to models using more predictor variables. Run the following code to determine the best model for predicting a team’s runs in a season using backward selection with AIC as the criterion (note that lower AIC indicates a better model).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">runs_backAIC &lt;-<span class="st"> </span><span class="kw">step</span>(runs_full, <span class="dt">direction =</span> <span class="st">&quot;backward&quot;</span>)
<span class="kw">summary</span>(runs_backAIC)</code></pre></div>
<hr />
<p><strong>Exercise 2:</strong> How many steps did the backward selection using AIC conduct before selecting a model? Which variable was the first to be removed? Which variables ended up in the final model? How many parameters are being estimated in this final model? How many of the parameters in this final model are significantly different than 0 at the 0.05 level? Does this final model have a higher <span class="math inline">\(R^2_{adj}\)</span> than the full model for runs?</p>
<hr />
<p>Instead of AIC, let’s use <span class="math inline">\(R^2_{adj}\)</span> as our criterion when conducting backward selection. Remember that <span class="math inline">\(R^2_{adj}\)</span> indicates a better model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 1</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. , mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>at_bats, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>hits, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>homeruns, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>bat_avg, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>strikeouts, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>stolen_bases, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_slug, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_obs, mlb11_runs))<span class="op">$</span>adj.r</code></pre></div>
<p>Since the model which removed <code>new_onbase</code> has the highest <span class="math inline">\(R^2_{adj}\)</span> we move onto step 2 using that model and continue by removing one variable at a time and calculate the new <span class="math inline">\(R^2_{adj}\)</span> for each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 2</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>at_bats, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>hits, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>homeruns, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>bat_avg, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>stolen_bases, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>new_slug, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>new_obs, mlb11_runs))<span class="op">$</span>adj.r</code></pre></div>
<p>Since the model in step 2 that removed <code>strikeouts</code> has the highest <span class="math inline">\(R^2_{adj}\)</span> we move onto step 3 using the model that now has both <code>new_onbase</code> and <code>strikeouts</code> removed and continue by removing one variable at a time and calculating the new <span class="math inline">\(R^2_{adj}\)</span> for each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 3</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>at_bats, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>hits, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>bat_avg, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>stolen_bases, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>new_slug, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>new_obs, mlb11_runs))<span class="op">$</span>adj.r</code></pre></div>
<p>Since none of the models which remove one more additional variable from the model that already excludes both <code>new_onbase</code> and <code>strikeouts</code> have larger <span class="math inline">\(R^2_{adj}\)</span>, we stop the process and now have a final model. In the code below we store the final model and look at a summary of the final model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">runs_backADJr &lt;-<span class="st"> </span><span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts, mlb11_runs)
<span class="kw">summary</span>(runs_backADJr)</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Which variables ended up in the final model when using backward selection with <span class="math inline">\(R^2_{adj}\)</span>? How many parameters are being estimated in this final model? How many of the parameters in this final model are significantly different than 0 at the 0.05 level? Does this final model have a higher <span class="math inline">\(R^2_{adj}\)</span> than the full model for runs? Higher than the final model when using backward selection with AIC?</li>
</ol>
<p>Finally let’s use a p-value method with a 0.05 significance level as our criterion when conducting backward selection. Remember that higher p-values are bad so we remove a variable when if it has the highest p-value which is greater than 0.05. If all p-values are less than 0.05 then we stop and we have arrived at our final model. Fortunately, R does have a function that makes this easier whish is <code>drop1()</code> - <code>add1()</code> is for forward selection. We must input the model fit and then indicate that <code>test = &quot;F&quot;</code> so p-values are printed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 1</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. , mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 2</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 3</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 4</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 5</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns <span class="op">-</span><span class="st"> </span>at_bats, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 6</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns <span class="op">-</span><span class="st"> </span>at_bats <span class="op">-</span><span class="st"> </span>hits, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 7</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns <span class="op">-</span><span class="st"> </span>at_bats <span class="op">-</span><span class="st"> </span>hits  <span class="op">-</span><span class="st"> </span>bat_avg, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)
<span class="co"># Step 8</span>
<span class="kw">drop1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns <span class="op">-</span><span class="st"> </span>at_bats <span class="op">-</span><span class="st"> </span>hits  <span class="op">-</span><span class="st"> </span>bat_avg <span class="op">-</span><span class="st"> </span>new_slug, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</code></pre></div>
<p>Below we store the final model selected under this method and examinie it using <code>summary()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Final model using backward selection with p-value criterion</span>
runs_backPval &lt;-<span class="st"> </span><span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>new_onbase <span class="op">-</span><span class="st"> </span>strikeouts <span class="op">-</span><span class="st"> </span>homeruns <span class="op">-</span><span class="st"> </span>at_bats <span class="op">-</span><span class="st"> </span>hits  <span class="op">-</span><span class="st"> </span>bat_avg <span class="op">-</span><span class="st"> </span>new_slug, mlb11_runs)
<span class="kw">summary</span>(runs_backPval)</code></pre></div>
<hr />
<p><strong>Exercise 4:</strong> Which variables ended up in the final model using a p-value method with a 0.05 significance level as our criterion when conducting backward selection? How many parameters are being estimated in this final model? How many of the parameters in this final model are significantly different than 0 at the 0.05 level? Does this final model have a higher <span class="math inline">\(R^2_{adj}\)</span> than the full model for runs? Why might someone prefer this final model over all of the models thus far?</p>
<hr />
</div>
<div id="predicting-runs-with-forward-selection" class="section level3">
<h3><span class="header-section-number">9.3.2</span> Predicting runs with forward selection</h3>
<p>The first step in forward selection is to set up a null/base model to build up from. This model could include variables that researchers stipulate a model must have for theoretical reasons. No such variables exisit in our case which means our null model will only have the intercept in it. We must also specify the full model so the preocedure knows which models to attempt. Note that the full model will be athe same as in backward selection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Creating the null model for runs</span>
runs_null &lt;-<span class="st"> </span><span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> mlb11_runs)
<span class="kw">summary</span>(runs_null)</code></pre></div>
<p>Now that we have a null model defined we can go about forward model selection. Once again we will us the <code>step()</code> function in R to use AIC (Akiake’s Information Criterion) for model selection - remember that lower AIC indicates a better model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">runs_forwardAIC &lt;-<span class="st"> </span><span class="kw">step</span>(runs_null, <span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="dt">scope =</span> <span class="kw">formula</span>(runs_full))
<span class="kw">summary</span>(runs_forwardAIC)</code></pre></div>
<hr />
<p><strong>Exercise 5:</strong> How many steps did the forward selection using AIC conduct before selecting a model? Which variable was the first to be added? Which previous selection method does this agree with - this doesn’t always happen?</p>
<hr />
<p>Instead of AIC, let’s use <span class="math inline">\(R^2_{adj}\)</span> as our criterion when conducting forward selection. Remember that <span class="math inline">\(R^2_{adj}\)</span> indicates a better model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 1</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="dv">1</span> , mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>at_bats, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>hits, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>homeruns, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>bat_avg, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>strikeouts, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>stolen_bases, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>new_onbase, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>new_slug, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="op">+</span><span class="st"> </span>new_obs, mlb11_runs))<span class="op">$</span>adj.r</code></pre></div>
<p>Since the model that added <code>new_obs</code> has the highest <span class="math inline">\(R^2_{adj}\)</span> we move onto step 2 using that model and continue by adding one variable at a time and calculate the new <span class="math inline">\(R^2_{adj}\)</span> for each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 2</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>at_bats, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>hits, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>homeruns, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>bat_avg, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>strikeouts, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>new_onbase, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>new_slug, mlb11_runs))<span class="op">$</span>adj.r</code></pre></div>
<p>Since the model is step 2 that added <code>stolen_bases</code> has the highest <span class="math inline">\(R^2_{adj}\)</span> we move onto step 3 using that model and continue by adding one variable at a time and calculate the new <span class="math inline">\(R^2_{adj}\)</span> for each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 3</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>at_bats, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>hits, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>homeruns, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>bat_avg, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>strikeouts, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>new_onbase, mlb11_runs))<span class="op">$</span>adj.r
<span class="kw">summary</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases <span class="op">+</span><span class="st"> </span>new_slug, mlb11_runs))<span class="op">$</span>adj.r</code></pre></div>
<p>Since none of the models that added one more variable in step 3 resulted in an increased <span class="math inline">\(R^2_{adj}\)</span>, we stop the process and now have a final model. In the code below we store the final model and look at a summary of the final model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">runs_forwardADJr &lt;-<span class="st"> </span><span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases, mlb11_runs)
<span class="kw">summary</span>(runs_forwardADJr)</code></pre></div>
<hr />
<p><strong>Exercise 6:</strong> Does the final model selected using forward selection with <span class="math inline">\(R^2_{adj}\)</span> differ from the final model using forward selection with AIC?</p>
<hr />
<p>Finally let’s use a p-value method with a 0.05 significance level as our criterion when conducting forward selection. Remember that hlower p-values are consider better so we add a variable when it has the lowest p-value and is less than 0.05. If newly added variable is not less than 0.05 then we stop and conclude that we have arrived at our final model. Fortunately, R does have a function that makes this easier which is <code>add1()</code>. We must input model fit, the possible full model, and then indicate that the <code>test = &quot;F&quot;</code> so p-values are printed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 1</span>
<span class="kw">add1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span><span class="dv">1</span> , mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>, <span class="dt">scope =</span> <span class="kw">formula</span>(runs_full))
<span class="co"># Step 2</span>
<span class="kw">add1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs , mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>, <span class="dt">scope =</span> <span class="kw">formula</span>(runs_full))
<span class="co"># Step 3</span>
<span class="kw">add1</span>(<span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases, mlb11_runs), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>, <span class="dt">scope =</span> <span class="kw">formula</span>(runs_full))</code></pre></div>
<p>Below we store the final model selected under this method and examinie it using <code>summary()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Final model using backward selection with p-value criterion</span>
runs_forwardPval &lt;-<span class="st"> </span><span class="kw">lm</span>(runs <span class="op">~</span><span class="st"> </span>new_obs <span class="op">+</span><span class="st"> </span>stolen_bases, mlb11_runs)
<span class="kw">summary</span>(runs_forwardPval)</code></pre></div>
<hr />
<p><strong>Exercise 7:</strong> What do you note about the final model selected using forward selection with p-values? This does not always occur.</p>
<hr />
</div>
</div>
<div id="assessing-the-conditions" class="section level2">
<h2><span class="header-section-number">9.4</span> Assessing the conditions</h2>
<p>After conducting a model selection procedures we should conduct graphical checks to explore wheather our conditions for multiple regression are being met. R has built in command for basic diagnostic plots. Simply use the <code>plot()</code> function and input the model that you desire diagnostic plots for as demonstrated in the code below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(runs_backAIC)</code></pre></div>
<p>None of the models have and severe departures from our necessary conditions for multiple regression. Diagnostic methods can be tricky and to really get a good understanding of them will require either further self-study or taking a regression course.</p>
<hr />
</div>
<div id="on-your-own-8" class="section level2">
<h2><span class="header-section-number">9.5</span> On Your Own</h2>
<ul>
<li><p>Using all the available variables in our dataset, conduct backward selection using AIC to select the best model for predicting <code>wins</code> for a team in a single season. <strong>Hints: make sure you are using the <code>mlb11_wins</code> dataset.</strong> How many variables are being used to predict <code>wins</code> in the full model? Which variables are included in the this final model?</p></li>
<li><p>Construct a 95% confidence interval for one of the slopes in the final model from part 1.</p></li>
<li><p>Conduct backward selection using <span class="math inline">\(R^2_{adj}\)</span> and then p-value method to select the best model for predicting <code>wins</code>. Do either of the final models selected using these criterions match the final model selected using backward selection with AIC? Do they match eachother?</p></li>
<li><p>Conduct forward selection with the three different criterions we have been using to select the best model for predicting <code>wins</code> for each. Are they all the same? Different?</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": "2"
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["kuyper-stat202.pdf", "kuyper-stat202.epub"],
"toc": {
"collapse": "none"
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
