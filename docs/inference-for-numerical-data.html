<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>OpenIntro Statistics: Labs for R</title>
  <meta name="description" content="This book contains labs for an introduction to statistics course. Each lab steps through the process of using the R programming language for collecting, analyzing, and using statistical data to make inferences and conclusions about real world phenomena.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="OpenIntro Statistics: Labs for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains labs for an introduction to statistics course. Each lab steps through the process of using the R programming language for collecting, analyzing, and using statistical data to make inferences and conclusions about real world phenomena." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="OpenIntro Statistics: Labs for R" />
  
  <meta name="twitter:description" content="This book contains labs for an introduction to statistics course. Each lab steps through the process of using the R programming language for collecting, analyzing, and using statistical data to make inferences and conclusions about real world phenomena." />
  



<meta name="date" content="2018-01-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="confidence-intervals-foundations-for-statistical-inference.html">
<link rel="next" href="inference-for-categorical-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">OpenIntro Statistics: Labs for R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#using-these-labs"><i class="fa fa-check"></i><b>0.1</b> Using these labs</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#about-the-contributors"><i class="fa fa-check"></i><b>0.2</b> About the Contributors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="working-efficiently-with-rstudio.html"><a href="working-efficiently-with-rstudio.html"><i class="fa fa-check"></i><b>1</b> Working Efficiently with RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="working-efficiently-with-rstudio.html"><a href="working-efficiently-with-rstudio.html#why-rstudio"><i class="fa fa-check"></i><b>1.1</b> Why RStudio?</a></li>
<li class="chapter" data-level="1.2" data-path="working-efficiently-with-rstudio.html"><a href="working-efficiently-with-rstudio.html#setting-up-an-r-project"><i class="fa fa-check"></i><b>1.2</b> Setting Up an R Project</a></li>
<li class="chapter" data-level="1.3" data-path="working-efficiently-with-rstudio.html"><a href="working-efficiently-with-rstudio.html#summary"><i class="fa fa-check"></i><b>1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-data-dr.arbuthnots-baptism-records"><i class="fa fa-check"></i><b>2.1</b> The Data: Dr. Arbuthnot’s Baptism Records</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#some-exploration"><i class="fa fa-check"></i><b>2.2</b> Some Exploration</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#excercise-1"><i class="fa fa-check"></i><b>2.2.1</b> Excercise 1</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-2"><i class="fa fa-check"></i><b>2.2.2</b> Exercise 2</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-3"><i class="fa fa-check"></i><b>2.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#on-your-own"><i class="fa fa-check"></i><b>2.3</b> On Your Own</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#acknowledgements"><i class="fa fa-check"></i><b>2.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-data.html"><a href="introduction-to-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to Data</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#exercise-1"><i class="fa fa-check"></i><b>3.1.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-data.html"><a href="introduction-to-data.html#summaries-and-tables"><i class="fa fa-check"></i><b>3.2</b> Summaries and tables</a><ul>
<li class="chapter" data-level="3.2.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#exercise-2-1"><i class="fa fa-check"></i><b>3.2.1</b> Exercise 2</a></li>
<li class="chapter" data-level="3.2.2" data-path="introduction-to-data.html"><a href="introduction-to-data.html#exercise-3-1"><i class="fa fa-check"></i><b>3.2.2</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-data.html"><a href="introduction-to-data.html#interlude-how-r-thinks-about-data"><i class="fa fa-check"></i><b>3.3</b> Interlude: How R thinks about data</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-data.html"><a href="introduction-to-data.html#a-little-more-on-subsetting"><i class="fa fa-check"></i><b>3.4</b> A little more on subsetting</a><ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#exercise-4"><i class="fa fa-check"></i><b>3.4.1</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-data.html"><a href="introduction-to-data.html#quantitative-data"><i class="fa fa-check"></i><b>3.5</b> Quantitative data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#exercise-5"><i class="fa fa-check"></i><b>3.5.1</b> Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-data.html"><a href="introduction-to-data.html#on-your-own-1"><i class="fa fa-check"></i><b>3.6</b> On Your Own</a></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-data.html"><a href="introduction-to-data.html#acknowledgements-1"><i class="fa fa-check"></i><b>3.7</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html"><i class="fa fa-check"></i><b>4</b> The Normal Distribution</a><ul>
<li class="chapter" data-level="4.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#getting-started-1"><i class="fa fa-check"></i><b>4.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#the-data"><i class="fa fa-check"></i><b>4.2</b> The Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-1-1"><i class="fa fa-check"></i><b>4.2.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#normal-distribution"><i class="fa fa-check"></i><b>4.3</b> Normal distribution</a><ul>
<li class="chapter" data-level="4.3.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-2-2"><i class="fa fa-check"></i><b>4.3.1</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#evaluating-the-normal-distribution"><i class="fa fa-check"></i><b>4.4</b> Evaluating the normal distribution</a><ul>
<li class="chapter" data-level="4.4.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-4-1"><i class="fa fa-check"></i><b>4.4.1</b> Exercise 4</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-5-1"><i class="fa fa-check"></i><b>4.4.2</b> Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#normal-probabilities"><i class="fa fa-check"></i><b>4.5</b> Normal probabilities</a><ul>
<li class="chapter" data-level="4.5.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-6"><i class="fa fa-check"></i><b>4.5.1</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#on-your-own-2"><i class="fa fa-check"></i><b>4.6</b> On Your Own</a></li>
<li class="chapter" data-level="4.7" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#acknowledgements-2"><i class="fa fa-check"></i><b>4.7</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html"><i class="fa fa-check"></i><b>5</b> Foundations for Statistical Inference - Sampling Distributions</a><ul>
<li class="chapter" data-level="5.1" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#getting-started-2"><i class="fa fa-check"></i><b>5.1</b> Getting started</a></li>
<li class="chapter" data-level="5.2" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#the-data-1"><i class="fa fa-check"></i><b>5.2</b> The data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#exercise-1-2"><i class="fa fa-check"></i><b>5.2.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#the-unknown-sampling-distribution"><i class="fa fa-check"></i><b>5.3</b> The unknown sampling distribution</a><ul>
<li class="chapter" data-level="5.3.1" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#exercise-2-3"><i class="fa fa-check"></i><b>5.3.1</b> Exercise 2</a></li>
<li class="chapter" data-level="5.3.2" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#exercise-3-2"><i class="fa fa-check"></i><b>5.3.2</b> Exercise 3</a></li>
<li class="chapter" data-level="5.3.3" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#exercise-4-2"><i class="fa fa-check"></i><b>5.3.3</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#interlude-the-for-loop"><i class="fa fa-check"></i><b>5.4</b> Interlude: The <code>for</code> loop</a><ul>
<li class="chapter" data-level="5.4.1" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#exercise-5-2"><i class="fa fa-check"></i><b>5.4.1</b> Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#sample-size-and-the-sampling-distribution"><i class="fa fa-check"></i><b>5.5</b> Sample size and the sampling distribution</a><ul>
<li class="chapter" data-level="5.5.1" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#exercise-6-1"><i class="fa fa-check"></i><b>5.5.1</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#on-your-own-3"><i class="fa fa-check"></i><b>5.6</b> On your own</a></li>
<li class="chapter" data-level="5.7" data-path="foundations-for-statistical-inference-sampling-distributions.html"><a href="foundations-for-statistical-inference-sampling-distributions.html#acknowledgements-3"><i class="fa fa-check"></i><b>5.7</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html"><i class="fa fa-check"></i><b>6</b> Confidence Intervals - Foundations for Statistical Inference</a><ul>
<li class="chapter" data-level="6.1" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#sampling-from-ames-iowa"><i class="fa fa-check"></i><b>6.1</b> Sampling from Ames, Iowa</a></li>
<li class="chapter" data-level="6.2" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#the-data-2"><i class="fa fa-check"></i><b>6.2</b> The data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#exercise-1-3"><i class="fa fa-check"></i><b>6.2.1</b> Exercise 1</a></li>
<li class="chapter" data-level="6.2.2" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#exercise-2-4"><i class="fa fa-check"></i><b>6.2.2</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>6.3</b> Confidence intervals</a><ul>
<li class="chapter" data-level="6.3.1" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#exercise-3-3"><i class="fa fa-check"></i><b>6.3.1</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#confidence-levels"><i class="fa fa-check"></i><b>6.4</b> Confidence levels</a><ul>
<li class="chapter" data-level="6.4.1" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#exercise-4-3"><i class="fa fa-check"></i><b>6.4.1</b> Exercise 4</a></li>
<li class="chapter" data-level="6.4.2" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#exercise-5-3"><i class="fa fa-check"></i><b>6.4.2</b> Exercise 5</a></li>
<li class="chapter" data-level="6.4.3" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#exercise-6-2"><i class="fa fa-check"></i><b>6.4.3</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#on-your-own-4"><i class="fa fa-check"></i><b>6.5</b> On your own</a></li>
<li class="chapter" data-level="6.6" data-path="confidence-intervals-foundations-for-statistical-inference.html"><a href="confidence-intervals-foundations-for-statistical-inference.html#acknowledgements-4"><i class="fa fa-check"></i><b>6.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html"><i class="fa fa-check"></i><b>7</b> Inference for Numerical Data</a><ul>
<li class="chapter" data-level="7.1" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#overview"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#north-carolina-births"><i class="fa fa-check"></i><b>7.2</b> North Carolina births</a></li>
<li class="chapter" data-level="7.3" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#exploratory-analysis"><i class="fa fa-check"></i><b>7.3</b> Exploratory analysis</a></li>
<li class="chapter" data-level="7.4" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#on-your-own-5"><i class="fa fa-check"></i><b>7.4</b> On your own</a></li>
<li class="chapter" data-level="7.5" data-path="inference-for-numerical-data.html"><a href="inference-for-numerical-data.html#acknowledgements-5"><i class="fa fa-check"></i><b>7.5</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html"><i class="fa fa-check"></i><b>8</b> Inference for Categorical Data</a><ul>
<li class="chapter" data-level="8.0.1" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#getting-started-3"><i class="fa fa-check"></i><b>8.0.1</b> Getting Started</a></li>
<li class="chapter" data-level="8.1" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#the-survey"><i class="fa fa-check"></i><b>8.1</b> The survey</a></li>
<li class="chapter" data-level="8.2" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#the-data-3"><i class="fa fa-check"></i><b>8.2</b> The data</a></li>
<li class="chapter" data-level="8.3" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#inference-on-proportions"><i class="fa fa-check"></i><b>8.3</b> Inference on proportions</a></li>
<li class="chapter" data-level="8.4" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#how-does-the-proportion-affect-the-margin-of-error"><i class="fa fa-check"></i><b>8.4</b> How does the proportion affect the margin of error?</a></li>
<li class="chapter" data-level="8.5" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#success-failure-condition"><i class="fa fa-check"></i><b>8.5</b> Success-failure condition</a></li>
<li class="chapter" data-level="8.6" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#on-your-own-6"><i class="fa fa-check"></i><b>8.6</b> On your own</a></li>
<li class="chapter" data-level="8.7" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#options-for-using-built-in-functions-in-r-prop.test-binom.test"><i class="fa fa-check"></i><b>8.7</b> Options for using built in functions in R: <code>prop.test()</code> &amp; <code>binom.test()</code></a></li>
<li class="chapter" data-level="8.8" data-path="inference-for-categorical-data.html"><a href="inference-for-categorical-data.html#acknowledgements-6"><i class="fa fa-check"></i><b>8.8</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>9</b> Introduction to Linear Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#batter-up-getting-started"><i class="fa fa-check"></i><b>9.1</b> Batter up (Getting Started)</a></li>
<li class="chapter" data-level="9.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-4"><i class="fa fa-check"></i><b>9.2</b> The data</a></li>
<li class="chapter" data-level="9.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#sum-of-squared-residuals"><i class="fa fa-check"></i><b>9.3</b> Sum of squared residuals</a></li>
<li class="chapter" data-level="9.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-linear-model"><i class="fa fa-check"></i><b>9.4</b> The linear model</a></li>
<li class="chapter" data-level="9.5" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#prediction-and-prediction-errors"><i class="fa fa-check"></i><b>9.5</b> Prediction and prediction errors</a></li>
<li class="chapter" data-level="9.6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>9.6</b> Model diagnostics</a></li>
<li class="chapter" data-level="9.7" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#on-your-own-7"><i class="fa fa-check"></i><b>9.7</b> On Your Own</a></li>
<li class="chapter" data-level="9.8" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#acknowledgements-7"><i class="fa fa-check"></i><b>9.8</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>10</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="10.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#getting-started-4"><i class="fa fa-check"></i><b>10.1</b> Getting Started</a></li>
<li class="chapter" data-level="10.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#the-data-5"><i class="fa fa-check"></i><b>10.2</b> The data</a></li>
<li class="chapter" data-level="10.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#the-search-for-the-best-model"><i class="fa fa-check"></i><b>10.3</b> The search for the best model</a><ul>
<li class="chapter" data-level="10.3.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#predicting-runs-with-backward-selection"><i class="fa fa-check"></i><b>10.3.1</b> Predicting runs with backward selection</a></li>
<li class="chapter" data-level="10.3.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#predicting-runs-with-forward-selection"><i class="fa fa-check"></i><b>10.3.2</b> Predicting runs with forward selection</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#assessing-the-conditions"><i class="fa fa-check"></i><b>10.4</b> Assessing the conditions</a></li>
<li class="chapter" data-level="10.5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#on-your-own-8"><i class="fa fa-check"></i><b>10.5</b> On Your Own</a></li>
<li class="chapter" data-level="10.6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#acknowledgements-8"><i class="fa fa-check"></i><b>10.6</b> Acknowledgements</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.libraries.northwestern.edu" target="blank">Published by Northwestern University Libraries</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">OpenIntro Statistics: Labs for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inference-for-numerical-data" class="section level1">
<h1><span class="header-section-number">7</span> Inference for Numerical Data</h1>
<hr />
<p>The lab is structured to guide you through an organized process such that you could easily organize your code with comments – meaning your R script – into a lab report. I would suggest getting into the habit of writing an organized and commented R script that completes the tasks and answers the questions provided in the lab – including in the <strong>Own Your Own</strong> section.</p>
<hr />
<div id="overview" class="section level2">
<h2><span class="header-section-number">7.1</span> Overview</h2>
<p>We will be conducting hypothesis tests (HTs) and constructing confidence intervals (CIs) for means and difference of means throughout this lab. We will calculate them by “hand” and through the use of a built in function in R called <code>t.test()</code>, which is an extremely useful and flexible function when given the raw sample. Sometimes we are only given access to sample statistics (e.g. <span class="math inline">\(\bar{x}\)</span>, <span class="math inline">\(s_x\)</span>, <span class="math inline">\(n\)</span>), which necessitates that we perform calculations by “hand” – the function <code>t.test()</code> requires the raw data.</p>
</div>
<div id="north-carolina-births" class="section level2">
<h2><span class="header-section-number">7.2</span> North Carolina births</h2>
<p>In 2004, the state of North Carolina released a large data set containing information on all births recorded in their state. This data set is useful to researchers studying the relation between habits and practices of expectant mothers and the birth of their children. We will work with a random sample of observations from this data set.</p>
</div>
<div id="exploratory-analysis" class="section level2">
<h2><span class="header-section-number">7.3</span> Exploratory analysis</h2>
<p>Load the <code>nc</code> data set into our workspace.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">download.file</span>(<span class="st">&quot;http://www.openintro.org/stat/data/nc.RData&quot;</span>, <span class="dt">destfile =</span> <span class="st">&quot;nc.RData&quot;</span>)</a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw">load</span>(<span class="st">&quot;nc.RData&quot;</span>)</a></code></pre></div>
<p>We observations of 13 different variables, some categorical and some numerical. The meaning of each variable is as follows:</p>
<table>
<colgroup>
<col width="59%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th>variable</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fage</code></td>
<td>father’s age in years.</td>
</tr>
<tr class="even">
<td><code>mage</code></td>
<td>mother’s age in years.</td>
</tr>
<tr class="odd">
<td><code>mature</code></td>
<td>maturity status of mother.</td>
</tr>
<tr class="even">
<td><code>weeks</code></td>
<td>length of pregnancy in weeks.</td>
</tr>
<tr class="odd">
<td><code>premie</code></td>
<td>whether the birth was classified as premature (premie) or full-term.</td>
</tr>
<tr class="even">
<td><code>visits</code></td>
<td>number of hospital visits during pregnancy.</td>
</tr>
<tr class="odd">
<td><code>marital</code></td>
<td>whether mother is <code>married</code> or <code>not married</code> at birth.</td>
</tr>
<tr class="even">
<td><code>gained</code></td>
<td>weight gained by mother during pregnancy in pounds.</td>
</tr>
<tr class="odd">
<td><code>weight</code></td>
<td>weight of the baby at birth in pounds.</td>
</tr>
<tr class="even">
<td><code>lowbirthweight</code></td>
<td>whether baby was classified as low birthweight (<code>low</code>) or not (<code>not low</code>).</td>
</tr>
<tr class="odd">
<td><code>gender</code></td>
<td>gender of the baby, <code>female</code> or <code>male</code>.</td>
</tr>
<tr class="even">
<td><code>habit</code></td>
<td>status of the mother as a <code>nonsmoker</code> or a <code>smoker</code>.</td>
</tr>
<tr class="odd">
<td><code>whitemom</code></td>
<td>whether mom is <code>white</code> or <code>not white</code>.</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>What are the cases in this data set? How many cases are there in our sample?</li>
</ol>
<p>As a first step in the analysis, we should consider summaries of the data. This can be done using the <code>summary</code> command:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="kw">summary</span>(nc)</a></code></pre></div>
<p>As you review the variable summaries, consider which variables are categorical and which are numerical. For numerical variables, are there outliers? If you aren’t sure or want to take a closer look at the data, make a graph.</p>
<p>Suppose we want to investigate the typical age for mothers and fathers in North Carolina. Begin by constructing histograms, box plots, and calculating summary statistics.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="co"># Mother&#39;s age</span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="kw">hist</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="kw">boxplot</span>(nc<span class="op">$</span>mage, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="kw">summary</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="kw">sd</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="kw">IQR</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb91-7" data-line-number="7"></a>
<a class="sourceLine" id="cb91-8" data-line-number="8"><span class="co"># Father&#39;s age</span></a>
<a class="sourceLine" id="cb91-9" data-line-number="9"><span class="kw">hist</span>(nc<span class="op">$</span>fage)</a>
<a class="sourceLine" id="cb91-10" data-line-number="10"><span class="kw">boxplot</span>(nc<span class="op">$</span>fage, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="kw">summary</span>(nc<span class="op">$</span>fage)</a>
<a class="sourceLine" id="cb91-12" data-line-number="12"><span class="kw">sd</span>(nc<span class="op">$</span>fage)</a>
<a class="sourceLine" id="cb91-13" data-line-number="13"><span class="kw">IQR</span>(nc<span class="op">$</span>fage)</a></code></pre></div>
<p>Note that <code>sd(nc$fage)</code> or <code>IQR(nc$fage)</code> do not return valid output/values. The summary output indicated that there were 171 births where a father’s age was missing or not reported. By default most R function will not return valid output when data is missing. This can be fixed by adding the argument <code>na.rm = TRUE</code> in the function call – see below.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="co"># Father&#39;s age continued</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="kw">sd</span>(nc<span class="op">$</span>fage, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb92-3" data-line-number="3"><span class="kw">IQR</span>(nc<span class="op">$</span>fage, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Suppose we want to test the hypothesis that the mean age for women giving birth in North Carolina is 26.5 years. Calculating by “hand”:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="co"># Sample Data</span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb93-3" data-line-number="3">std &lt;-<span class="st"> </span><span class="kw">sd</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb93-4" data-line-number="4">samp_size &lt;-<span class="st"> </span><span class="kw">length</span>(nc<span class="op">$</span>mage)</a>
<a class="sourceLine" id="cb93-5" data-line-number="5"></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="co"># Hypothesis Test -- Calculating p-value</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7">dof &lt;-<span class="st"> </span>samp_size <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb93-8" data-line-number="8">std_err &lt;-<span class="st"> </span>std<span class="op">/</span><span class="kw">sqrt</span>(samp_size)</a>
<a class="sourceLine" id="cb93-9" data-line-number="9">test_stat &lt;-<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span><span class="fl">26.5</span>)<span class="op">/</span>std_err</a>
<a class="sourceLine" id="cb93-10" data-line-number="10">p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="op">-</span><span class="kw">abs</span>(test_stat),<span class="dt">df =</span> dof)</a>
<a class="sourceLine" id="cb93-11" data-line-number="11">p_value</a>
<a class="sourceLine" id="cb93-12" data-line-number="12"></a>
<a class="sourceLine" id="cb93-13" data-line-number="13"><span class="co"># Constructing 95% CI for the mean</span></a>
<a class="sourceLine" id="cb93-14" data-line-number="14">t_star &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> <span class="fl">.975</span>, <span class="dt">df =</span> dof)</a>
<a class="sourceLine" id="cb93-15" data-line-number="15">LB &lt;-<span class="st"> </span>xbar <span class="op">-</span><span class="st"> </span>t_star<span class="op">*</span>std_err</a>
<a class="sourceLine" id="cb93-16" data-line-number="16">UB &lt;-<span class="st"> </span>xbar <span class="op">+</span><span class="st"> </span>t_star<span class="op">*</span>std_err</a>
<a class="sourceLine" id="cb93-17" data-line-number="17"><span class="kw">c</span>(LB,UB)</a></code></pre></div>
<p>Since our p-value is less than significance level <span class="math inline">\(\alpha\)</span> (0.05), we have sufficient evidence to reject that the mean age of women giving birth in North Carolina is 26.5 years old. Note that 26.5 is not in the 95% confidence interval for the mean age of birthing women in NC. Two-tailed hypothesis tests for the mean with significance level <span class="math inline">\(\alpha\)</span> are logically equivalent to <span class="math inline">\(100(1-\alpha)\%\)</span> confidence interval for the mean – <strong>this is a big deal</strong>.</p>
<p>Let’s make use of the <code>t.test()</code> function now. The function has several inputs that you should become familiar with and work to understand.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="co"># Mother&#39;s mean age -- HT and 95% CI</span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="kw">t.test</span>(<span class="dt">x =</span> nc<span class="op">$</span>mage, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="fl">26.5</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Suppose now we want test whether the mean age of NC fathers is 30 years. Use <span class="math inline">\(\alpha = 0.01\)</span>. Also construct a 99% confidence interval for the mean. Calculate by “hand” and by using <code>t.test()</code>. <em>Hint: When calculating by “hand”, missing values can be an issue so first extract and store the useful observations as shown below. The <code>t.test()</code> takes care of missingness automatically.</em></li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="co"># Extract and store useful data</span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2">keep_condition &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(nc<span class="op">$</span>fage)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3">f_age &lt;-<span class="st"> </span>nc<span class="op">$</span>fage[keep_condition]</a></code></pre></div>
<p>Suppose a researcher wants to test the hypothesis that in NC the mean age of fathers is different than the mean age of mothers at birth – assume an <span class="math inline">\(\alpha = 0.01\)</span>. This is a test for the difference in two population means, which requires us to ask whether the data for the two groups (mothers and fathers) is paired or not. Clearly, the data is paired since each mother and father can be reasonably matched together. First by “hand”,</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="co"># Paired -- only need the differences in age</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2">age_diff &lt;-<span class="st"> </span>nc<span class="op">$</span>mage <span class="op">-</span><span class="st"> </span>nc<span class="op">$</span>fage  </a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="kw">summary</span>(age_diff)</a>
<a class="sourceLine" id="cb96-4" data-line-number="4"></a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="co"># Diff. sample statistics -- note their are missing values</span></a>
<a class="sourceLine" id="cb96-6" data-line-number="6">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(age_diff, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-7" data-line-number="7">std &lt;-<span class="st"> </span><span class="kw">sd</span>(age_diff, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-8" data-line-number="8">samp_size &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(age_diff))</a>
<a class="sourceLine" id="cb96-9" data-line-number="9"></a>
<a class="sourceLine" id="cb96-10" data-line-number="10"><span class="co"># Hypothesis Test -- Calculating p-value</span></a>
<a class="sourceLine" id="cb96-11" data-line-number="11">dof &lt;-<span class="st"> </span>samp_size <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb96-12" data-line-number="12">std_err &lt;-<span class="st"> </span>std<span class="op">/</span><span class="kw">sqrt</span>(samp_size)</a>
<a class="sourceLine" id="cb96-13" data-line-number="13">test_stat &lt;-<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span><span class="dv">0</span>)<span class="op">/</span>std_err</a>
<a class="sourceLine" id="cb96-14" data-line-number="14">p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="op">-</span><span class="kw">abs</span>(test_stat),<span class="dt">df =</span> dof)</a>
<a class="sourceLine" id="cb96-15" data-line-number="15">p_value</a>
<a class="sourceLine" id="cb96-16" data-line-number="16"></a>
<a class="sourceLine" id="cb96-17" data-line-number="17"><span class="co"># Constructing 99% CI for the mean</span></a>
<a class="sourceLine" id="cb96-18" data-line-number="18">t_star &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> <span class="fl">.995</span>, <span class="dt">df =</span> dof)</a>
<a class="sourceLine" id="cb96-19" data-line-number="19">LB &lt;-<span class="st"> </span>xbar <span class="op">-</span><span class="st"> </span>t_star<span class="op">*</span>std_err</a>
<a class="sourceLine" id="cb96-20" data-line-number="20">UB &lt;-<span class="st"> </span>xbar <span class="op">+</span><span class="st"> </span>t_star<span class="op">*</span>std_err</a>
<a class="sourceLine" id="cb96-21" data-line-number="21"><span class="kw">c</span>(LB,UB)</a></code></pre></div>
<p>Using <code>t.test()</code> – a few coding options.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="co"># Option 1: Calculate the differences externally and feed</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="co"># them into the t.test function</span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="kw">t.test</span>(<span class="dt">x =</span> age_diff, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">conf.level =</span> <span class="fl">0.99</span>)</a>
<a class="sourceLine" id="cb97-4" data-line-number="4"></a>
<a class="sourceLine" id="cb97-5" data-line-number="5"><span class="co"># Option 2: Let the function calculate the differences by</span></a>
<a class="sourceLine" id="cb97-6" data-line-number="6"><span class="co"># setting paired = TRUE</span></a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="kw">t.test</span>(<span class="dt">x =</span> nc<span class="op">$</span>mage, <span class="dt">y =</span> nc<span class="op">$</span>fage, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Now consider the possible relationship between a mother’s smoking habit and the weight of her baby. Plotting the data is a useful first step because it helps us quickly visualize trends, identify strong associations, and develop research
questions.</p>
<ol start="3" style="list-style-type: decimal">
<li>Make a side-by-side box plot of <code>habit</code> and <code>weight</code>. What does the plot highlight about the relationship between these two variables?</li>
</ol>
<p>The box plots show how the medians of the two distributions compare, but we can also compare the means of the distributions using the following function to split the <code>weight</code> variable into the <code>habit</code> groups, then take the mean of each using the <code>mean</code> function.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">by</span>(nc<span class="op">$</span>weight, nc<span class="op">$</span>habit, mean)</a></code></pre></div>
<p>There is an observed difference, but is this difference statistically significant? In order to answer this question we will conduct a hypothesis test.</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Check if the conditions necessary for inference are satisfied. Note that you will need to obtain sample sizes to check the conditions. You can compute the group size using the same <code>by</code> command above but replacing <code>mean</code> with <code>length</code>.</p></li>
<li><p>Write the hypotheses for testing if the average weights of babies born to smoking and non-smoking mothers are different.</p></li>
</ol>
<p>Again, this a hypothesis test for a difference of two means, but in this case the data is not paired – there is no reasonable way of matching members from one group (smokers) to the other (non-smokers). Are the two groups independent from one another? There is no reason to believe that the groups are dependent since the records were randomly sampled. First by “hand”,</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="co"># Sample statistics for baby weights for smoking mothers</span></a>
<a class="sourceLine" id="cb99-2" data-line-number="2">grp1 &lt;-<span class="st"> </span>nc<span class="op">$</span>weight[nc<span class="op">$</span>habit <span class="op">==</span><span class="st"> &quot;smoker&quot;</span>]</a>
<a class="sourceLine" id="cb99-3" data-line-number="3">xbar1 &lt;-<span class="st"> </span><span class="kw">mean</span>(grp1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-4" data-line-number="4">std1 &lt;-<span class="st"> </span><span class="kw">sd</span>(grp1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-5" data-line-number="5">samp_size1 &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(grp1))</a>
<a class="sourceLine" id="cb99-6" data-line-number="6"></a>
<a class="sourceLine" id="cb99-7" data-line-number="7"><span class="co"># Sample statistics for baby weights for nonsmoking mothers</span></a>
<a class="sourceLine" id="cb99-8" data-line-number="8">grp2 &lt;-<span class="st"> </span>nc<span class="op">$</span>weight[nc<span class="op">$</span>habit <span class="op">==</span><span class="st"> &quot;nonsmoker&quot;</span>]</a>
<a class="sourceLine" id="cb99-9" data-line-number="9">xbar2 &lt;-<span class="st"> </span><span class="kw">mean</span>(grp2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-10" data-line-number="10">std2 &lt;-<span class="st"> </span><span class="kw">sd</span>(grp2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-11" data-line-number="11">samp_size2 &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(grp2))</a>
<a class="sourceLine" id="cb99-12" data-line-number="12"></a>
<a class="sourceLine" id="cb99-13" data-line-number="13"><span class="co"># Hypothesis Test -- Calculating p-value</span></a>
<a class="sourceLine" id="cb99-14" data-line-number="14">dof &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">c</span>(samp_size1,samp_size2)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb99-15" data-line-number="15">std_err &lt;-<span class="st"> </span><span class="kw">sqrt</span>(std1<span class="op">^</span><span class="dv">2</span><span class="op">/</span>samp_size1 <span class="op">+</span><span class="st"> </span>std2<span class="op">^</span><span class="dv">2</span><span class="op">/</span>samp_size2)</a>
<a class="sourceLine" id="cb99-16" data-line-number="16">test_stat &lt;-<span class="st"> </span>(xbar1<span class="op">-</span>xbar2 <span class="op">-</span><span class="st"> </span><span class="dv">0</span>)<span class="op">/</span>std_err</a>
<a class="sourceLine" id="cb99-17" data-line-number="17">p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="op">-</span><span class="kw">abs</span>(test_stat),<span class="dt">df =</span> dof)</a>
<a class="sourceLine" id="cb99-18" data-line-number="18">p_value</a>
<a class="sourceLine" id="cb99-19" data-line-number="19"></a>
<a class="sourceLine" id="cb99-20" data-line-number="20"><span class="co"># Constructing 95% CI for the mean</span></a>
<a class="sourceLine" id="cb99-21" data-line-number="21">t_star &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> <span class="fl">.975</span>, <span class="dt">df =</span> dof)</a>
<a class="sourceLine" id="cb99-22" data-line-number="22">LB &lt;-<span class="st"> </span>(xbar1 <span class="op">-</span><span class="st"> </span>xbar2) <span class="op">-</span><span class="st"> </span>t_star<span class="op">*</span>std_err</a>
<a class="sourceLine" id="cb99-23" data-line-number="23">UB &lt;-<span class="st"> </span>(xbar1 <span class="op">-</span><span class="st"> </span>xbar2) <span class="op">+</span><span class="st"> </span>t_star<span class="op">*</span>std_err</a>
<a class="sourceLine" id="cb99-24" data-line-number="24"><span class="kw">c</span>(LB,UB)</a></code></pre></div>
<p>Using <code>t.test()</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="co"># Note taht grp1 and grp2 come from above</span></a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="kw">t.test</span>(<span class="dt">x =</span> grp1, <span class="dt">y =</span> grp2, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">conf.level =</span> <span class="fl">.95</span>)</a></code></pre></div>
<p><strong>Notice that the by “hand” calculations and the results from <code>t.test()</code> do not match.</strong> The difference is caused by the use of different degrees of freedom calculations. The software is utilizing the exact calculation for the degrees of freedom while we are utilizing a <em>conservative</em> estimate to the degrees of freedom.</p>
<p>Also note <code>var.equal =</code> is an indicator/flag for whether we are willing to make the assumption that the two groups have equal variance (i.e. spread/variability). In most cases it is safer not to make this assumption, thus the default is <code>FALSE</code>. Although, some software and researchers will make this assumption. Set <code>var.equal = TRUE</code> and see what happens. <strong>What affect did this assumption have on the p-value and confidence interval?</strong></p>
<hr />
</div>
<div id="on-your-own-5" class="section level2">
<h2><span class="header-section-number">7.4</span> On your own</h2>
<ul>
<li><p>Calculate a 95% confidence interval for the average length of pregnancies (<code>weeks</code>) and interpret it in context.</p></li>
<li><p>Calculate a new confidence interval for the same parameter at the 90% confidence level.</p></li>
<li><p>Conduct a hypothesis test evaluating whether the average weight gained by younger mothers is different than the average weight gained by mature mothers.</p></li>
<li><p>Now, a non-inference task: Determine the age cutoff for younger and mature mothers. Use a method of your choice, and explain how your method works.</p></li>
<li><p>Pick a pair of numerical and categorical variables and come up with a research question evaluating the relationship between these variables. Formulate the question in a way that it can be answered using a hypothesis test and/or a confidence interval. Answer your question using the <code>t.test()</code> function, report the statistical results, and also provide an explanation in plain language.</p></li>
</ul>
<hr />
</div>
<div id="acknowledgements-5" class="section level2">
<h2><span class="header-section-number">7.5</span> Acknowledgements</h2>
<p>“Inference for numerical data” by <a href="https://www.statistics.northwestern.edu/people/faculty/arend-m-kuyper.html" target="_blank">Arend Kuyper</a>, Northwestern University, is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC BY-SA 4.0</a> / A derivative from the <a href="http://htmlpreview.github.io/?https://github.com/andrewpbray/oiLabs-base-R/blob/master/inf_for_numerical_data/inf_for_numerical_data.html" target="_blank">original work</a> by Andrew Bray, Mine Çetinkaya-Rundel, and Mark Hansen.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="confidence-intervals-foundations-for-statistical-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inference-for-categorical-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": "2"
},
"edit": {
"link": null,
"text": null
},
"download": ["kuyper-stat202.pdf", "kuyper-stat202.epub"],
"toc": {
"collapse": "none"
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
